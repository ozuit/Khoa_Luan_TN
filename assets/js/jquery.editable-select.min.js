!function(e){e.extend(e.expr[":"],{nic:function(e,i,t,s){return!(0<=(e.textContent||e.innerText||"").toLowerCase().indexOf((t[3]||"").toLowerCase()))}}),e.fn.editableSelect=function(i){var t=this.clone(),s=e('<input type="text" name="thoihan">'),n=e('<ul class="es-list">');switch(i=e.extend({},{filter:!0,effect:"default",duration:"fast",onCreate:null,onShow:null,onHide:null,onSelect:null},i),i.effects){case"default":case"fade":case"slide":break;default:i.effects="default"}return(isNaN(i.duration)||"fast"!=i.duration||"slow"!=i.duration)&&(i.duration="fast"),this.replaceWith(s),{init:function(){var l=this;l.copyAttributes(t,s),s.addClass("es-input"),e(document.body).append(n),t.find("option").each(function(){var i=e("<li>"),t=e(this);i.data("value",t.val()),i.html(t.text()),l.copyAttributes(this,i),n.append(i),e(this).attr("selected")&&s.val(t.text())}),s.on("focus input click",l.show),e(document).on("click",function(i){e(i.target).is(s)||e(i.target).is(n)||l.hide()}),l.initializeList(),l.initializeEvents(),i.onCreate&&i.onCreate.call(this,s)},initializeList:function(){var i=this;n.find("li").each(function(){e(this).on("mousemove",function(){n.find(".selected").removeClass("selected"),e(this).addClass("selected")}),e(this).on("click",function(){i.setField.call(this,i)})}),n.mouseenter(function(){n.find("li.selected").removeClass("selected")})},initializeEvents:function(){var e=this;s.bind("input keydown",function(i){switch(i.keyCode){case 40:e.show(),i=n.find("li:visible");var t=i.filter("li.selected");n.find(".selected").removeClass("selected"),t=i.eq(0<t.size()?i.index(t)+1:0),t=(0<t.size()?t:n.find("li:visible:first")).addClass("selected"),e.scroll(t,!0);break;case 38:e.show(),i=n.find("li:visible"),t=i.filter("li.selected"),n.find("li.selected").removeClass("selected"),t=i.eq(0<t.size()?i.index(t)-1:-1),(0<t.size()?t:n.find("li:visible:last")).addClass("selected"),e.scroll(t,!1);break;case 13:n.is(":visible")&&(e.setField.call(n.find("li.selected"),e),i.preventDefault());case 9:case 27:e.hide();break;default:e.show()}})},show:function(){if(n.find("li").show(),n.css({top:s.offset().top+s.outerHeight()-1,left:s.offset().left,width:s.innerWidth()}),(i.filter?n.find("li:nic("+s.val()+")").hide().size():0)==n.find("li").size())n.hide();else switch(i.effects){case"fade":n.fadeIn(i.duration);break;case"slide":n.slideDown(i.duration);break;default:n.show(i.duration)}i.onShow&&i.onShow.call(this,s)},hide:function(){switch(i.effects){case"fade":n.fadeOut(i.duration);break;case"slide":n.slideUp(i.duration);break;default:n.hide(i.duration)}i.onHide&&i.onHide.call(this,s)},scroll:function(i,t){var s=0,l=n.find("li:visible").index(i);n.find("li:visible").each(function(i,t){i<l&&(s+=e(t).outerHeight())}),(s+i.outerHeight()>=n.scrollTop()+n.outerHeight()||s<=n.scrollTop())&&(t?n.scrollTop(s+i.outerHeight()-n.outerHeight()):n.scrollTop(s))},copyAttributes:function(i,t){var s,n=e(i)[0].attributes;for(s in n)e(t).attr(n[s].nodeName,n[s].nodeValue)},setField:function(t){return!!e(this).is("li:visible")&&(s.val(e(this).text()),t.hide(),void(i.onSelect&&i.onSelect.call(s,e(this))))}}.init(),s}}(jQuery);